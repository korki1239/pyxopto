
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>xopto.pf.miemlpd module &#8212; PyXOpto 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="xopto.pf.mienormal module" href="xopto.pf.mienormal.html" />
    <link rel="prev" title="xopto.pf.miemlnormal module" href="xopto.pf.miemlnormal.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-xopto.pf.miemlpd">
<span id="xopto-pf-miemlpd-module"></span><h1>xopto.pf.miemlpd module<a class="headerlink" href="#module-xopto.pf.miemlpd" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="xopto.pf.miemlpd.MieMlPd">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">MieMlPd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nlayers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmedium</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drange</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nd</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dscalefun</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xopto/pf/miemlpd.html#MieMlPd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.miemlpd.MieMlPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="xopto.pf.pfbase.html#xopto.pf.pfbase.PfBase" title="xopto.pf.pfbase.PfBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.pf.pfbase.PfBase</span></code></a></p>
<p>Mie scattering phase function for layered spherical particles that
follow the given size probability density function within the given
range of outer diameters.
By default, the layer stack is multiplicatively scaled to the current
value of the outer diameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayers</strong> (<em>float</em><em>, </em><em>complex</em><em>, </em><em>list</em><em>, </em><em>tuple</em><em>, </em><em>numpy.ndarray vector</em>) – Refractive indices (complex) of the concentric spherical layers,
starting with the refractive index of the innermost layer.</p></li>
<li><p><strong>nmedium</strong> (<em>float</em><em>, </em><em>complex</em>) – Refractive index (complex) of the surrounding medium.</p></li>
<li><p><strong>diameters</strong> (<em>float</em><em>, </em><em>list</em><em>, </em><em>tuple</em><em>, </em><em>numpy.ndarray vector</em>) – Diameters of the concentric spherical layers (m), starting with
the innermost layer. The layer stack is scaled according
to the current diameter of the distribution. A custom scaling
function can be passed in the scalefum parameter.
A multiplicative scaling of the layer stack to the current
outer diameter given by the distribution is used by default.</p></li>
<li><p><strong>wavelength</strong> (<em>float</em>) – Wavelength of light (m).</p></li>
<li><p><strong>pd</strong> (<em>Callable</em><em>[</em><em>[</em><em>float</em><em>]</em><em>, </em><em>float</em><em>]</em>) – Particlne number density distribution function. Integral
of pd over diameter range given in drange should equal 1.0.</p></li>
<li><p><strong>drange</strong> (<em>[</em><em>float</em><em>, </em><em>float</em><em>] or </em><em>(</em><em>float</em><em>, </em><em>float</em><em>)</em>) – Layered spherical particle outer diameter range as [dmin, dmax],
where dmin and dmax stand for the minimum and maximum diameter of
spherical particles, respectively.</p></li>
<li><p><strong>nd</strong> (<em>int</em>) – Number of equally spaced control points between dmin and dmax that
are used to estimate the phase function. A fixed-step Simpson
numerical integration is used to estimate the phase function at
the given deflection angle cosines. If nd is None, adaptive-step
numerical integration is used (note that the computational time
might increase dramatically!!!).</p></li>
<li><p><strong>scalefun</strong> (<em>Callable</em><em>[</em><em>[</em><em>np.ndarray</em><em>, </em><em>float</em><em>]</em><em>, </em><em>float</em><em>]</em>) – A function that scales the layer stack to the current outer diameter
of the distribution.
If None (default), multiplicative scaling is used to transfor
the layer stack so that the outermost layer diameter matches the
current distribution diameter.</p></li>
<li><p><strong>limit</strong> (<em>int</em>) – An upper bound on the number of subintervals used in the quad
adaptive algorithm. Set to None for default value.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Mie scattering phase function for a normal distribution of
hollow spherical particles with a mean outer diameter of 1 um, standard
deviation of 100 nm, a wall thickness that equals 5% of the outer
diameter, wall refractive index of 1.45, for 550 nm monochromatic light
(vacuum) suspended in water (refractive index 1.33). A 7-sigma
diameter range is used for numerical computation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">pp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">xopto.pf.distribution</span> <span class="kn">import</span> <span class="n">Normal</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmean</span> <span class="o">=</span> <span class="mf">1e-6</span>    <span class="c1"># normal particle distrbution mean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsigma</span> <span class="o">=</span> <span class="mf">0.1e-6</span> <span class="c1"># normal particle distribution standard deviation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">dmean</span><span class="p">,</span> <span class="n">dsigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">miemlpd</span> <span class="o">=</span> <span class="n">MieMlPd</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.45</span><span class="p">],</span> <span class="mf">1.33</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.9e-6</span><span class="p">,</span> <span class="mf">1.0e-6</span><span class="p">],</span> <span class="mf">550e-9</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">range</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf_values</span> <span class="o">=</span> <span class="n">miemlpd</span><span class="p">(</span><span class="n">cos_theta</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">cos_theta</span><span class="p">,</span> <span class="n">pf_values</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.miemlpd.MieMlPd.acs">
<span class="sig-name descname"><span class="pre">acs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/xopto/pf/miemlpd.html#MieMlPd.acs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.miemlpd.MieMlPd.acs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the absorption cross section.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.miemlpd.MieMlPd.distribution">
<span class="sig-name descname"><span class="pre">distribution</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../_modules/xopto/pf/miemlpd.html#MieMlPd.distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.miemlpd.MieMlPd.distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the underlaying size distribution object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>pd</strong> – A callable size distribution that takes the size
parameter/diameter and returns the corresponding probability
density.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Callable[[float], float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.miemlpd.MieMlPd.ecs">
<span class="sig-name descname"><span class="pre">ecs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/xopto/pf/miemlpd.html#MieMlPd.ecs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.miemlpd.MieMlPd.ecs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the extinction cross section.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.miemlpd.MieMlPd.fastg">
<span class="sig-name descname"><span class="pre">fastg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/xopto/pf/miemlpd.html#MieMlPd.fastg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.miemlpd.MieMlPd.fastg" title="Permalink to this definition">¶</a></dt>
<dd><p>Overloads the <code class="xref py py-meth docutils literal notranslate"><span class="pre">PfBase.fastg()</span></code> method of the base class.
.. note:: If n is 1, a precalculated g1 is returned.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.miemlpd.MieMlPd.g">
<span class="sig-name descname"><span class="pre">g</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/xopto/pf/miemlpd.html#MieMlPd.g"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.miemlpd.MieMlPd.g" title="Permalink to this definition">¶</a></dt>
<dd><p>Overloads the <code class="xref py py-meth docutils literal notranslate"><span class="pre">PfBase.g()</span></code> method of the base class.
Computes the n-th Legendre moment of the scattering phase function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If n is 1, a precalculated g1 is returned.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.miemlpd.MieMlPd.pd">
<span class="sig-name descname"><span class="pre">pd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diameter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/xopto/pf/miemlpd.html#MieMlPd.pd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.miemlpd.MieMlPd.pd" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the number density function at the specified particle
diameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>diameter</strong> (<em>float</em>) – Particle diameter (m).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pd</strong> – The value of number density function at the specified
particle diameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.miemlpd.MieMlPd.scale">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../_modules/xopto/pf/miemlpd.html#MieMlPd.scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.miemlpd.MieMlPd.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiplicatively scale the diameters of the layer stack to
match the outer diameter of the stack with the specified diameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>diameters</strong> (<em>np.ndarray</em>) – Diameters of the layer stack.</p></li>
<li><p><strong>diameter</strong> (<em>float</em>) – Target outer diameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scaled_diameters</strong> – Diameters of the layer stack scaled to the specified outer diameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.miemlpd.MieMlPd.scs">
<span class="sig-name descname"><span class="pre">scs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/xopto/pf/miemlpd.html#MieMlPd.scs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.miemlpd.MieMlPd.scs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the scattering cross section.</p>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/xopto_logo_bright.png" alt="Logo"/>
    
    <h1 class="logo logo-name">PyXOpto</h1>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../source/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/opencl_devices.html">OpenCL devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/mcml/index.html">Layered MC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/mcvox/index.html">Voxelized MC</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">xopto</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="xopto.html">xopto package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="xopto.html#subpackages">Subpackages</a></li>
<li class="toctree-l3"><a class="reference internal" href="xopto.html#module-xopto">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">xopto</a><ul>
  <li><a href="xopto.html">xopto package</a><ul>
  <li><a href="xopto.pf.html">xopto.pf package</a><ul>
      <li>Previous: <a href="xopto.pf.miemlnormal.html" title="previous chapter">xopto.pf.miemlnormal module</a></li>
      <li>Next: <a href="xopto.pf.mienormal.html" title="next chapter">xopto.pf.mienormal module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, XOpto team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>