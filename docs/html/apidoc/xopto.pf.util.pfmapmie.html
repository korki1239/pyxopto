
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>xopto.pf.util.pfmapmie module &#8212; PyXOpto 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="xopto.pf.util.pfmapmpc module" href="xopto.pf.util.pfmapmpc.html" />
    <link rel="prev" title="xopto.pf.util.pfmapmhg module" href="xopto.pf.util.pfmapmhg.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-xopto.pf.util.pfmapmie">
<span id="xopto-pf-util-pfmapmie-module"></span><h1>xopto.pf.util.pfmapmie module<a class="headerlink" href="#module-xopto.pf.util.pfmapmie" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MieFractalPolystyreneMap">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">MieFractalPolystyreneMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ng</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drange</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">(5e-09,</span> <span class="pre">3e-05)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nd</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncostheta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MieFractalPolystyreneMap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MieFractalPolystyreneMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="xopto.pf.util.pfmapbase.html#xopto.pf.util.pfmapbase.PfMap2DBase" title="xopto.pf.util.pfmapbase.PfMap2DBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.pf.util.pfmapbase.PfMap2DBase</span></code></a></p>
<p>Prepares maps of the first ng Legendre moments of the
MieFractalPolystyrene (FMIE) phase function, over the specified
range of the FMIE parameters alpha and wavelength. If ng &gt;= 2, a map of
gamma is preapred and if ng &gt;= 3 maps of delta and sigma are
prepared as well. The maps are used to obtain an initial estimate
when calculateng the FMIE phase function parameters from given
Legendre moments, gamma and/or delta.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<em>np.ndarray vector</em>) – A Vector of equally spaced values defining the grid density of
the alpha parameter of the Fractal Mie phase function.</p></li>
<li><p><strong>wavelength</strong> (<em>np.ndarray vector</em>) – A Vector of equally spaced values defining the grid density of
the a wavelength parameter of Fractal Mie phase function [m].</p></li>
<li><p><strong>drange</strong> (<em>list</em><em>, </em><em>tuple of two float</em>) – Finite range (m) of the particle diameter used to compute the
scattering phase function given as (dmin, dmax). If None, default
a range [5e-9, 30e-6] m is used.</p></li>
<li><p><strong>nd</strong> (<em>int</em>) – Number of equally spaced control points between dmin and dmax that
are used to estimate the phase function. A fixed-step Simpson
numerical integration is used to estimate the phase function at
the given deflection angle cosines. If nd is None, adaptive-step
numerical integration is used (note that the computational time
might increase dramatically!!!).</p></li>
<li><p><strong>ng</strong> (<em>int</em>) – Maps are created for the first ng Legendre moments. If ng &gt;= 2,
a map of gamma is prepared and if g &gt;= 3 maps of delta and sigma
are prepared as well.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – File with saved data. The values of all the other parameters are
ignored and restored from the file.</p></li>
<li><p><strong>ncostheta</strong> (<em>int</em>) – Number of nodes used to compute the Legendre moments. Use a
large number (&gt; 1000) for accurate results. If None, adaptive
step integration is used, which is accurate but can become slow.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The value of parameter ng should be &gt;&gt; 3 to accurately
estimate the value of parameter sigma.</p>
</div>
<p class="rubric">Examples</p>
<p>Prepares maps of gamma and delta, and estimates the FMIE parameters
given a) g and gamma are known b) gamma and delta are known.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">MieFractalPolystyreneMap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.4e-6</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="n">ng</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span><span class="p">,</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">invgammadelta</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">2.2</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">3.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gamma=2.2, delta=3.5 ==&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="s1">&#39;wavelength:&#39;</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span><span class="p">,</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">invgamma</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">2.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g=0.8, gamma=2.2 ==&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="s1">&#39;wavelength:&#39;</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Load maps from the default file included in the data/pf folder.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">MieFractalPolystyreneMap</span><span class="o">.</span><span class="n">fromfile</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span><span class="p">,</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">invgammadelta</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">2.2</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">3.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gamma=2.2, delta=3.5 ==&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="s1">&#39;wavelength:&#39;</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span><span class="p">,</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">invgamma</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">2.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g=0.8, gamma=2.2 ==&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="s1">&#39;wavelength:&#39;</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.DEFAULT_MAP_FILE">
<span class="sig-name descname"><span class="pre">DEFAULT_MAP_FILE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'fractal_mie_polystyrene_map.npz'</span></em><a class="headerlink" href="#xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.DEFAULT_MAP_FILE" title="Permalink to this definition">¶</a></dt>
<dd><p>A filename for the default map.
Overload this static member in derived classes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.PLOTSCALEFACTORX">
<span class="sig-name descname"><span class="pre">PLOTSCALEFACTORX</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1.0</span></em><a class="headerlink" href="#xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.PLOTSCALEFACTORX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.PLOTSCALEFACTORY">
<span class="sig-name descname"><span class="pre">PLOTSCALEFACTORY</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1000000000.0</span></em><a class="headerlink" href="#xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.PLOTSCALEFACTORY" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for computing maps of scattering phase function quantifiers
as a function ot the scattering phase functions parameters - only for
two-parametric scattering phase functions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.XLABEL">
<span class="sig-name descname"><span class="pre">XLABEL</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'$\\alpha$'</span></em><a class="headerlink" href="#xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.XLABEL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.YLABEL">
<span class="sig-name descname"><span class="pre">YLABEL</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'$\\lambda</span> <span class="pre">(nm)$'</span></em><a class="headerlink" href="#xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.YLABEL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MieFractalPolystyreneMap.alpha"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a vector of points defining the grid of alpha parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.alpha_grid">
<span class="sig-name descname"><span class="pre">alpha_grid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MieFractalPolystyreneMap.alpha_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.alpha_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 2D map (meshgrid) of the first scattering phase function
parameter alpha.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.precalculate">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">precalculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MieFractalPolystyreneMap.precalculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.precalculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Precalculate fractal Mie polystyrene scattering phase function lookup table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of steps along the scattering phase function parameters.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Output file or None to save as the default lookup table.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Turn on verbose progress report.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.wavelength">
<span class="sig-name descname"><span class="pre">wavelength</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MieFractalPolystyreneMap.wavelength"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a vector of points defining the grid of wavelengths.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.wavelength_grid">
<span class="sig-name descname"><span class="pre">wavelength_grid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MieFractalPolystyreneMap.wavelength_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MieFractalPolystyreneMap.wavelength_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 2D map (meshgrid) of the second parameter of the
scatterin phase function wavelength.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MiePolystyreneMap">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">MiePolystyreneMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diameter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ng</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MiePolystyreneMap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MiePolystyreneMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="xopto.pf.util.pfmapbase.html#xopto.pf.util.pfmapbase.PfMap2DBase" title="xopto.pf.util.pfmapbase.PfMap2DBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">xopto.pf.util.pfmapbase.PfMap2DBase</span></code></a></p>
<p>Prepares maps of the first ng Legendre moments of the
MiePolystyrene scattering phase function, over the specified
range of spherical particle diameters and wavelengths.
If ng &gt;= 2, a map of gamma is prepared and if ng &gt;= 3 maps of delta
and sigma are prepared as well. The maps are used to obtain an
initial estimate when calculating the MIE scattering phase function
parameters from the given Legendre moments, gamma and/or delta.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>diameter</strong> (<em>np.ndarray vector</em>) – A Vector of equally spaced values defining the grid density of
the micro-sphere diameter parameter of Mie phase function[m].</p></li>
<li><p><strong>wavelength</strong> (<em>np.ndarray vector</em>) – A Vector of equally spaced values defining the grid density of
the a wavelength parameter of Mie phase function[m].</p></li>
<li><p><strong>ng</strong> (<em>int</em>) – Maps are created for the first ng Legendre moments. If ng &gt;= 2,
a map of gamma is prepared and if g &gt;= 3 maps of delta and sigma
are prepared as well.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – File with saved data. The values of all the other parameters are
ignored and restored from the file.</p></li>
<li><p><strong>ncostheta</strong> (<em>int</em>) – Number of nodes used to compute the Legendre moments. Use a
large number (&gt; 1000) for accurate results. If None, adaptive
step integration is used, which is accurate but can become slow.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The value of parameter ng should be &gt;&gt; 3 to accurately
estimate the value of parameter sigma.</p>
</div>
<p class="rubric">Examples</p>
<p>Prepares maps of gamma and delta, and estimates the MIE parameters
given a) g and gamma are known b) gamma and delta are known.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">MiePolystyreneMap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2e-6</span><span class="p">,</span> <span class="mf">5e-6</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.4e-6</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">ng</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diameter</span><span class="p">,</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">invgammadelta</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">2.2</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">3.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gamma=2.2, delta=3.5 ==&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;diameter:&#39;</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="s1">&#39;wavelength:&#39;</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diameter</span><span class="p">,</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">invgamma</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">2.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g=0.8, gamma=2.2 ==&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;diameter:&#39;</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="s1">&#39;wavelength:&#39;</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Load maps from the default file included in the data/pf folder.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">MiePolystyreneMap</span><span class="o">.</span><span class="n">fromfile</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diameter</span><span class="p">,</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">invgammadelta</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">2.2</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">3.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gamma=2.2, delta=3.5 ==&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;diameter:&#39;</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="s1">&#39;wavelength:&#39;</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diameter</span><span class="p">,</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">invgamma</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">2.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g=0.8, gamma=2.2 ==&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;diameter:&#39;</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="s1">&#39;wavelength:&#39;</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MiePolystyreneMap.DEFAULT_MAP_FILE">
<span class="sig-name descname"><span class="pre">DEFAULT_MAP_FILE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'mie_polystyrene_map.npz'</span></em><a class="headerlink" href="#xopto.pf.util.pfmapmie.MiePolystyreneMap.DEFAULT_MAP_FILE" title="Permalink to this definition">¶</a></dt>
<dd><p>A filename for the default map.
Overload this static member in derived classes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MiePolystyreneMap.PLOTSCALEFACTORX">
<span class="sig-name descname"><span class="pre">PLOTSCALEFACTORX</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1000000000.0</span></em><a class="headerlink" href="#xopto.pf.util.pfmapmie.MiePolystyreneMap.PLOTSCALEFACTORX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MiePolystyreneMap.PLOTSCALEFACTORY">
<span class="sig-name descname"><span class="pre">PLOTSCALEFACTORY</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1000000000.0</span></em><a class="headerlink" href="#xopto.pf.util.pfmapmie.MiePolystyreneMap.PLOTSCALEFACTORY" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for computing maps of scattering phase function quantifiers
as a function ot the scattering phase functions parameters - only for
two-parametric scattering phase functions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MiePolystyreneMap.XLABEL">
<span class="sig-name descname"><span class="pre">XLABEL</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'$d</span> <span class="pre">(nm)$'</span></em><a class="headerlink" href="#xopto.pf.util.pfmapmie.MiePolystyreneMap.XLABEL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MiePolystyreneMap.YLABEL">
<span class="sig-name descname"><span class="pre">YLABEL</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'$\\lambda</span> <span class="pre">(nm)$'</span></em><a class="headerlink" href="#xopto.pf.util.pfmapmie.MiePolystyreneMap.YLABEL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MiePolystyreneMap.diameter">
<span class="sig-name descname"><span class="pre">diameter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MiePolystyreneMap.diameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MiePolystyreneMap.diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a vector of points defining the grid of diameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MiePolystyreneMap.diameter_grid">
<span class="sig-name descname"><span class="pre">diameter_grid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MiePolystyreneMap.diameter_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MiePolystyreneMap.diameter_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 2D map (meshgrid) of the first parameter of the scattering
phase function (diameter).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MiePolystyreneMap.precalculate">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">precalculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MiePolystyreneMap.precalculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MiePolystyreneMap.precalculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Precalculate monodisperse Mie polystyrene scattering phase function
lookup table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of steps along the scattering phase function parameters.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Output file or None to save as the default lookup table.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Turn on verbose progress report.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MiePolystyreneMap.wavelength">
<span class="sig-name descname"><span class="pre">wavelength</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MiePolystyreneMap.wavelength"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MiePolystyreneMap.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a vector of points defining the grid of wavelengths.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.util.pfmapmie.MiePolystyreneMap.wavelength_grid">
<span class="sig-name descname"><span class="pre">wavelength_grid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xopto/pf/util/pfmapmie.html#MiePolystyreneMap.wavelength_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.util.pfmapmie.MiePolystyreneMap.wavelength_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 2D map (meshgrid) of the second parameter of the scattering
phase function (wavelength).</p>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/xopto_logo_bright.png" alt="Logo"/>
    
    <h1 class="logo logo-name">PyXOpto</h1>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../source/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/opencl_devices.html">OpenCL devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/mcml/index.html">Layered MC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/mcvox/index.html">Voxelized MC</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">xopto</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="xopto.html">xopto package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="xopto.html#subpackages">Subpackages</a></li>
<li class="toctree-l3"><a class="reference internal" href="xopto.html#module-xopto">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">xopto</a><ul>
  <li><a href="xopto.html">xopto package</a><ul>
  <li><a href="xopto.pf.html">xopto.pf package</a><ul>
  <li><a href="xopto.pf.util.html">xopto.pf.util package</a><ul>
      <li>Previous: <a href="xopto.pf.util.pfmapmhg.html" title="previous chapter">xopto.pf.util.pfmapmhg module</a></li>
      <li>Next: <a href="xopto.pf.util.pfmapmpc.html" title="next chapter">xopto.pf.util.pfmapmpc module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, XOpto team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>