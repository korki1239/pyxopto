
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>xopto.pf.pfbase module &#8212; PyXOpto 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="xopto.pf.rayleigh module" href="xopto.pf.rayleigh.html" />
    <link rel="prev" title="xopto.pf.pc module" href="xopto.pf.pc.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-xopto.pf.pfbase">
<span id="xopto-pf-pfbase-module"></span><h1>xopto.pf.pfbase module<a class="headerlink" href="#module-xopto.pf.pfbase" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="xopto.pf.pfbase.PfBase">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">PfBase</span></span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#PfBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.PfBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The base class of all scattering phase functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.pfbase.PfBase.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">costheta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'simpson'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#PfBase.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.PfBase.cdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Cumulative probability density function calculated at the specified
deflection angle cosines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>costheta</strong> (<em>np.ndarray</em>) – A vector of scattering angle cosines at which the cumulative
distribution function is to be computed.</p></li>
<li><p><strong>meth</strong> (<em>str</em>) – <dl class="simple">
<dt>Numerical integration method:</dt><dd><ul>
<li><p>’trapez’</p></li>
<li><p>’simpson’ - default</p></li>
<li><p>’quad’    - adaptive step; accurate but slower</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – Number of control points used by the trapez and simpson numerical
integration methods.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Optional keyword arguments passed to the scipy.integrate.quad
function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pfcum</strong> – Returns the cumulative probability density values at the given
scattering angle cosines.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Computation method ‘quad’ might be slower on some platforms, however
produces accurate results. Use ‘quad’ whenever possible. Otherwise
check the accuracy of results obtained by ‘simpson’ or ‘trapez’ and
adjust parameter npts if required (increase to improve accuracy,
decrease for faster computation and increased computational error).</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">pp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">costheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># define a phase function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">miepf</span> <span class="o">=</span> <span class="n">Mie</span><span class="p">(</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.33</span><span class="p">,</span> <span class="mf">4.5e-6</span><span class="p">,</span> <span class="mf">550e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># accurate but sometimes slow adaptive step-size integration by quad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdpf</span> <span class="o">=</span> <span class="n">miepf</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">costheta</span><span class="p">,</span> <span class="s1">&#39;quad&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># fast computation using simpson integration with 10000 control points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpffast</span> <span class="o">=</span> <span class="n">miepf</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">costheta</span><span class="p">,</span> <span class="s1">&#39;simpson&#39;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">costheta</span><span class="p">,</span> <span class="n">cdpf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">costheta</span><span class="p">,</span> <span class="n">cpffast</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.pfbase.PfBase.fastg">
<span class="sig-name descname"><span class="pre">fastg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costheta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#PfBase.fastg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.PfBase.fastg" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the n-th Legendre moment of the scattering phase function.
A fast fixed-step simpson quadrature is used to compute the Legendre
moment. Note that the default number of points “npts”
at which the value of scattering phase function is computed might be
insufficient for accurate estimation of higher order Legendre moments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The Legendre moment to calculate. (<img class="math" src="../_images/math/6c1ff1fa9d98053f892ccdaa411b17edee8da802.png" alt="n=1"/> yields the
anisotropy factor  <img class="math" src="../_images/math/2a80fda9315ae417b21c6c806451bcfea71f2401.png" alt="g_1"/>)</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – Number of points (scattering angle cosines) at which the scattering
phase function is estimated. The value is ignored if the value of
costheta parameter is not None.</p></li>
<li><p><strong>pf</strong> (<em>np.ndarray</em>) – A vector containing the values of the scattering phase function at
equally spaced scattering angle cosines from [-1, 1]. If None,
the values are calculated at scattering angle cosines defined by
argument costheta.</p></li>
<li><p><strong>costheta</strong> (<em>np.ndarray</em>) – <p>A vector of equally spaced numbers (scattering angle cosines) on
the interval [-1, 1] at which the scattering phase function
is defined. If None, the values are calculated as:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">np.linspace(-1.0,</span> <span class="pre">1.0,</span> <span class="pre">npts)</span></code> if pf is None</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">np.linspace(-1.0,</span> <span class="pre">1.0,</span> <span class="pre">pf.size)</span></code> if pf is not None</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>p</strong> – Value of the n-th Legendre moment.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.pfbase.PfBase.fastgs">
<span class="sig-name descname"><span class="pre">fastgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costheta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#PfBase.fastgs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.PfBase.fastgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the first n Legendre moments of the scattering phase function.
A fast fixed-step simpson quadrature is used to compute the Legendre
moments. Note that the default number of points “npts” at which the
value of scattering phase function is computed might be insufficient
for accurate estimation of higher order Legendre moments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>last</strong> (<em>int</em>) – The last Legendre moment to be calculate.</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – Number of points (scattering angle cosines) at which the scattering
phase function is estimated. The value is ignored if the value of
costheta parameter is not None.</p></li>
<li><p><strong>pf</strong> (<em>np.ndarray</em>) – A vector containing the values of the scattering phase function at
equally spaced scattering angle cosines from [-1, 1]. If None,
the values are calculated at scattering angle cosines defined
by argument costheta.</p></li>
<li><p><strong>costheta</strong> (<em>np.ndarray</em>) – <p>A vector of equally spaced numbers (scattering angle cosines) on
the interval [-1, 1] at which the scattering phase function is
defined. If None, the values are calculated as:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">np.linspace(-1.0,</span> <span class="pre">1.0,</span> <span class="pre">npts)</span></code> if pf is None</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">np.linspace(-1.0,</span> <span class="pre">1.0,</span> <span class="pre">pf.size)</span></code> if pf is not None</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>p</strong> – Values of Legendre moments from 0 to ‘last’ as a vector ([g_0, g_1, …, g_last]).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.pfbase.PfBase.g">
<span class="sig-name descname"><span class="pre">g</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#PfBase.g"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.PfBase.g" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the n-th Legendre moment of the scattering phase function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The Legendre moment to calculate. (n=1 is g_1 - anisotropy factor)</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Optional keyword arguments passed to scipy.integrate.quad function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>p</strong> – Value of the n-th Legendre moment.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.pfbase.PfBase.gs">
<span class="sig-name descname"><span class="pre">gs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#PfBase.gs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.PfBase.gs" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the first n Legendre moments of the scattering phase function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>last</strong> (<em>int</em>) – The last Legendre moment to be calculate.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Optional keyword arguments passed to scipy.integrate.quad function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>p</strong> – Legendre moments of the scatteing phase function
from 0 to ‘last’ as a vector a numpy vector
([g_0, g_1, …, g_last]).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.pfbase.PfBase.lut">
<span class="sig-name descname"><span class="pre">lut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncd</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#PfBase.lut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.PfBase.lut" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.pfbase.PfBase.mclut">
<span class="sig-name descname"><span class="pre">mclut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncd</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#PfBase.mclut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.PfBase.mclut" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares a nonlinear Monte Carlo lookup table for sampling the
scattering angles of the scattering phase function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The LUT size.</p></li>
<li><p><strong>ncd</strong> (<em>int</em>) – The number of equally spaced points (scattering angles) at which
the cumulative probability density of the scattering phase function
is calculated.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Parameters passed to the <a class="reference internal" href="#xopto.pf.pfbase.PfBase.cdf" title="xopto.pf.pfbase.PfBase.cdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PfBase.cdf()</span></code></a> method of the
scattering phase function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>params</strong> (<em>Tuple[float, float, float]</em>) – List or tuple of three parameters [a, b, c] that can be used
to estimate the scattering angle cosine from a unifor random number
F from [0, 1]:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">F</span> <span class="o">-</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">lut</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">first</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">index</span><span class="p">)),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lut</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lut</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="n">first</span>
<span class="n">costheta</span> <span class="o">=</span> <span class="n">lut</span><span class="p">[</span><span class="n">first</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">dx</span><span class="p">)</span> <span class="o">+</span> <span class="n">lut</span><span class="p">[</span><span class="n">second</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span>
</pre></div>
</div>
</li>
<li><p><strong>lut</strong> (<em>np.ndarray</em>) – LUT data as a vector of n elements.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The returned values can be used to create a Monte Carlo lookup table
by calling constructor <code class="code docutils literal notranslate"><span class="pre">mcbase.pf.Lut(*pf.mclut())</span></code>.</p>
</div>
<p class="rubric">Examples</p>
<p>Prepares a Monte Carlo lookup table-based scattering phase function
of a water dispersion containing 1 um microspherical particles with a
refractive index 1.6 (medium/water refractive index is 1.33) at 550 nm.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">pp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">xopto.mcbase</span> <span class="kn">import</span> <span class="n">mcpf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">xopto</span> <span class="kn">import</span> <span class="n">pf</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mie_pf</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">Mie</span><span class="p">(</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.33</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">550e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcpf</span> <span class="o">=</span> <span class="n">mcpf</span><span class="o">.</span><span class="n">Lut</span><span class="p">(</span><span class="o">*</span><span class="n">mie_pf</span><span class="o">.</span><span class="n">mclut</span><span class="p">())</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xopto.pf.pfbase.PfBase.mcluterr">
<span class="sig-name descname"><span class="pre">mcluterr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lut</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#PfBase.mcluterr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.PfBase.mcluterr" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the performance of the lookup table created by the
<a class="reference internal" href="#xopto.pf.pfbase.PfBase.mclut" title="xopto.pf.pfbase.PfBase.mclut"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PfBase.mclut()</span></code></a> method.</p>
<p>The parameters of this function are as returned by the
<a class="reference internal" href="#xopto.pf.pfbase.PfBase.mclut" title="xopto.pf.pfbase.PfBase.mclut"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PfBase.mclut()</span></code></a> method)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lut</strong> (<em>np.ndarray</em>) – Lookup table data as a numpy vector of length n.</p></li>
<li><p><strong>params</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>]</em>) – <p>A tuple of three parameters [a, b, c] that can be used to estimate
the scattering angle cosine from a unifor random number
F from [0, 1]:</p>
</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – Number of equally spaced points from [0.0, 1.0] at which the
scattering phase function is evaluated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>costheta</strong> (<em>np.ndarray</em>) – The estimated scattering angle cosines.</p></li>
<li><p><strong>flut</strong> (<em>np.ndarray</em>) – Cumulative probability density of the scattering phase function at
the given scattering angle cosines computed from the lookup table.</p></li>
<li><p><strong>ftrue</strong> (<em>np.ndarray vector</em>) – True values of the cumulative probability density of the scattering
phase function at the given scattering angle cosines.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">pp</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf</span> <span class="o">=</span> <span class="n">Mie</span><span class="p">(</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.33</span><span class="p">,</span> <span class="mf">5e-6</span><span class="p">,</span> <span class="mf">550e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">costheta</span><span class="p">,</span> <span class="n">flut</span><span class="p">,</span> <span class="n">ftrue</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">mcluterr</span><span class="p">(</span><span class="o">*</span><span class="n">pf</span><span class="o">.</span><span class="n">mclut</span><span class="p">(</span><span class="mi">512</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">costheta</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">flut</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CDF Estimated by LUT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">costheta</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">ftrue</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True CDF&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">costheta</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="n">flut</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">ftrue</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="n">ftrue</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Relative CDF error&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xopto.pf.pfbase.fastg">
<span class="sig-name descname"><span class="pre">fastg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costheta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#fastg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.fastg" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the n-th Legendre moment of the scattering phase function
defined on equally spaced grid of deflection angle cosines.
Note that if the scattering phase function is defined only at
a few points, the computed Legendre moments might be inaccurate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The Legendre moment to calculate. (<img class="math" src="../_images/math/6c1ff1fa9d98053f892ccdaa411b17edee8da802.png" alt="n=1"/> yields the anisotropy
factor <img class="math" src="../_images/math/2a80fda9315ae417b21c6c806451bcfea71f2401.png" alt="g_1"/>).</p></li>
<li><p><strong>pf</strong> (<em>np.ndarray</em>) – A vector containing the values of the scattering phase function at
equally spaced deflection angle cosines from [-1, 1].</p></li>
<li><p><strong>costheta</strong> (<em>np.ndarray</em>) – A vector of equally spaced numbers (deflection angle cosines) on
the interval [-1, 1] at which the phase function is estimated. If
None, costheta is calculated as np.linspace(-1.0, 1.0, pf.size)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>p</strong> – Value of the n-th Legendre moment.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xopto.pf.pfbase.fastgs">
<span class="sig-name descname"><span class="pre">fastgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costheta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#fastgs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.fastgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the first n Legendre moments of the scattering phase function
defined on equally spaced grid of deflection angle cosines.
Note that if the scattering phase function is defined only at
a few points, the computed Legendre moments might be inaccurate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>last</strong> (<em>int</em>) – The last Legendre moment to be calculate.</p></li>
<li><p><strong>pf</strong> (<em>np.ndarray</em>) – A vector containing the values of the scattering phase function at
equally spaced deflection angle cosines from [-1, 1].</p></li>
<li><p><strong>cotheta</strong> (<em>np.ndarray</em>) – A vector of equally spaced numbers (deflection angle cosines) on
the interval [-1, 1] at which the phase function is estimated. If
None, costheta is calculated as <code class="code docutils literal notranslate"><span class="pre">np.linspace(-1.0,</span> <span class="pre">1.0,</span> <span class="pre">pf.size)</span></code>.</p></li>
<li><p><strong>out</strong> (<em>np.ndarray</em>) – A vector of size last + 1 for storing the Legendre moments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>p</strong> – Values of Legendre moments from 0 to ‘last’ as a vector
<img class="math" src="../_images/math/28999d3853c77f064b3fad51a3a7d7c65e244ebf.png" alt="([g_0, g_1, ..., g_{last}])"/>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xopto.pf.pfbase.ilut_function">
<span class="sig-name descname"><span class="pre">ilut_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">randnum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#ilut_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.ilut_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse of the parametric approximation of the cumulative probability
density function Fap (python implementation lut_function):</p>
<div class="math">
<p><img src="../_images/math/1b1dccb5ad0761a7163b76786a3cde30b12cb647.png" alt="Fap^{-1}(F) &amp;= a/(F - c) - b,

where Fap^{-1}(-1) &amp;= 0 and Fap^{-1}(1) = 1."/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>costheta</strong> (<em>float</em><em> or </em><em>np.ndarray</em>) – A vector of values (cumulative distribution) from [0.0, 1.0] for
which the deflection angle cosine is computed.</p></li>
<li><p><strong>params</strong> (<em>list</em><em> or </em><em>tuple</em>) – Approximation function parameter list. This implementation requires
only one parameter c. Parameters a and b are calculated according
to the above equations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>approx</strong> – Deflection angle cosines approximations computed at the given
values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Inverse of the approximation function for several different values
of parameter a.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">pp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">C</span><span class="p">:</span>
<span class="go">        pp.plot(F, ilut_function(F, [c]), label=&#39;a={}&#39;.format(a))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;cos(theta)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xopto.pf.pfbase.lut_function">
<span class="sig-name descname"><span class="pre">lut_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">costheta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/xopto/pf/pfbase.html#lut_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#xopto.pf.pfbase.lut_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Parametric approximation of the cumulative probability density function
of the deflection angle cosine <img class="math" src="../_images/math/03161874d48c00c249007de55f660a5b5d8b33b7.png" alt="F(cos(\theta))"/>:</p>
<div class="math">
<p><img src="../_images/math/301abe4771f8fdad3807ab28932d0d31aabcc883.png" alt="Fap(\cos(\theta)) = \frac{a}{\cos(\theta) + b} + c,
where Fap(-1) = 0 and Fap(1) = 1."/></p>
</div><p>Given the th
wo constraints <img class="math" src="../_images/math/0c421cff9130fd1418ee52b5d16d69ac38ad6c43.png" alt="Fap(-1) = 0"/> and <img class="math" src="../_images/math/5dc7d6955c66167ba29c4b26e7124b331aef24df.png" alt="Fap(1) = 1"/>,
the approximation function is fully defined by parameter <img class="math" src="../_images/math/d520a12f1579170834c32ad5f656de081bbb36fe.png" alt="c"/>:</p>
<div class="math">
<p><img src="../_images/math/fe9930c2fe993deb3dc4e20c0ae39f2c871ae895.png" alt="b = 2 c - 1
a = 2 c (1 - c)"/></p>
</div><p>Depending on the convexity of <img class="math" src="../_images/math/2b6fcd0e67ee1094156636e231b01d6e12f54cf7.png" alt="Fap"/>, <img class="math" src="../_images/math/d520a12f1579170834c32ad5f656de081bbb36fe.png" alt="c"/> can be from
<img class="math" src="../_images/math/766fc52b4fb50fd3f6f076ce451ada26056d7b4b.png" alt="[-inf, 0)"/> or <img class="math" src="../_images/math/6a7e9e2a53d178eae9aac4d6591284767d88b360.png" alt="(1, \infty]"/>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>list</em><em> or </em><em>tuple</em>) – Approximation function parameter list. This implementation requires
only parameter c. Parameters a and b are calculated according
to the above equations.</p></li>
<li><p><strong>costheta</strong> (<em>float</em><em> or </em><em>np.ndarray</em>) – A vector of deflection angle cosines at which the
function is evaluated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>approx</strong> – Lut function approximation at the specified deflection angle cosines.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Approximation function for several different values of parameter a.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">pp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">costheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">C</span><span class="p">:</span>
<span class="go">        pp.plot(costheta, lut_function(costheta, [c]),</span>
<span class="go">        label=&#39;a={}&#39;.format(a))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;cos(theta)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/xopto_logo_bright.png" alt="Logo"/>
    
    <h1 class="logo logo-name">PyXOpto</h1>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../source/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/opencl_devices.html">OpenCL devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/mcml/index.html">Layered MC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/mcvox/index.html">Voxelized MC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/dataset/index.html">Datasets</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">xopto</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="xopto.html">xopto package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="xopto.html#subpackages">Subpackages</a></li>
<li class="toctree-l3"><a class="reference internal" href="xopto.html#module-xopto">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">xopto</a><ul>
  <li><a href="xopto.html">xopto package</a><ul>
  <li><a href="xopto.pf.html">xopto.pf package</a><ul>
      <li>Previous: <a href="xopto.pf.pc.html" title="previous chapter">xopto.pf.pc module</a></li>
      <li>Next: <a href="xopto.pf.rayleigh.html" title="next chapter">xopto.pf.rayleigh module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, XOpto team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>